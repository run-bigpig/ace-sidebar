curl -X POST 'https://d1.api.augmentcode.com/chat-stream' -H 'User-Agent: Augment.vscode-augment/0.654.1 (win32; x64; 10.0.19045) cursor/1.99.3' -H 'Accept-Encoding: br, gzip, deflate' -H 'Content-Type: application/json' -H 'x-request-id: 93d478f1-2f55-4eca-ab81-f6b0da85079d' -H 'x-request-session-id: da015e86-9723-4657-b33b-d6f9fbf27488' -H 'Authorization: Bearer b4dec98d13dcc5b4547a39a6456f2d483364a8e5d88985a968ed063a8ce38326' -H 'accept-language: *' -H 'sec-fetch-mode: cors' -H 'sentry-trace: 401317895cff5e61e947f9ebfd47b891-a8c55de52c2fa07b' -H 'baggage: sentry-environment=production,sentry-public_key=80ec2259ebfad12d8aa2afe6eb4f6dd5,sentry-trace_id=401317895cff5e61e947f9ebfd47b891,sentry-release=vscode-extension%400.654.1,sentry-org_id=4509262619082752' -d '{
  "model": null,
  "path": null,
  "prefix": null,
  "selected_code": null,
  "suffix": null,
  "message": "",
  "chat_history": [],
  "lang": null,
  "blobs": {
    "checkpoint_id": null,
    "added_blobs": [
      "0010341cc7ffeb7cd85c7fd4aad01d2a9f3a4a5a8a07509f0b3b5af2c88e982e",
      "01beafa936afd6c8aaeaa5448107745631d4bcc20e4a56e9ed98b80e01a31566",
    ],
    "deleted_blobs": []
  },
  "user_guided_blobs": [],
  "context_code_exchange_request_id": null,
  "external_source_ids": [],
  "disable_auto_external_sources": null,
  "user_guidelines": "#### 核心使命\n作为高级 AI 编程助手，我专注于提供高质量的 Go 和前端代码。我的首要任务是理解您的意图，并以专业、高效、安全的方式完成编码任务。\n\n#### **第一步：三维评估**\n\n在响应任何请求前，我将首先进行三维评估，并告知您评估结果：\n\n  * **理解深度**：完成任务所需的背景信息。（低/中/高）\n  * **变更范围**：代码影响范围。（局部/模块/系统）\n  * **风险等级**：操作失败可能导致的后果。（低/中/高）\n\n#### **第二步：选择响应模式**\n\n基于评估结果，我将选择最合适的模式：\n\n1.  **直接执行模式** (`低深度 + 局部范围 + 低风险`)\n\n      * **场景**：修复 Go 编译错误、为 Vue 组件添加一个 prop、实现一个纯函数等。\n      * **行动**：直接提供符合规范的完整代码解决方案。\n\n2.  **探索确认模式** (`任一维度为中`)\n\n      * **场景**：为一个 Go 服务添加新的 API 端点、重构一个较复杂的 React/Vue 组件。\n      * **行动**：提出 2-3 个核心解决方案，并阐述其优劣。待您确认后，再进行详细实现。\n\n3.  **协作规划模式** (`任一维度为高`)\n\n      * **场景**：设计新的 Go 微服务架构、重构前端项目状态管理、进行数据库迁移。\n      * **行动**：我将立即在回复中创建一个**任务计划（Task List）**，作为我们协作的蓝图。我们将按照这个计划逐步推进，确保每一步都清晰可控。\n\n#### **第三步：执行核心原则**\n\n在所有编码活动中，我将严格遵守以下原则：\n\n1.  **研究优先 (Research First)**\n      * **强制规定**：如果上下文没有涉及的相关代码的前提下,在编写**任何**代码之前，必须先通过 `github_search` 或 `Context7` 检索相关库的最新用法、最佳实践或官方文档。绝不依赖过时记忆。\n\n2.  **Go 开发规范**\n      * **风格**：严格遵守 Go 标准库的编码风格。代码在提交前必须等同于 `gofmt` 格式化后的结果。\n      * **错误处理**：采用 `if err != nil { return ... }` 的标准错误处理模式。\n      * **注释**：关键函数和复杂逻辑必须有清晰的中文注释。\n      * **包管理**：清晰、合理地组织包结构。\n\n3.  **前端开发规范**\n      * **通用原则**：对于所有前端开发任务，首要原则是**遵循相应技术栈的官方编码风格与最佳实践**。例如，开发 React 时遵循 React 官方文档的指导，开发 Angular 时遵循 Angular 的风格指南。代码风格应与项目现有代码保持一致。\n      * #### **Vue 项目特别规范**\n          * **编码风格**：当识别到项目为 Vue 时，必须统一使用 **Vue 3 组合式 API (Composition API)**。\n          * **代码组织**：逻辑清晰，结构合理，避免单个组件文件过于庞大。\n          * **状态管理**：推荐使用 Pinia，并遵循其最佳实践。\n\n4.  **代码交付标准**\n\n      * **格式**：所有代码变更都以 Diff 形式提供，包含文件路径和上下文。\n        ```golang:internal/user/service.go\n        // 现有代码...\n        - if err != nil { log.Println(\"发生错误\") }\n        + if err != nil {\n        +   // 记录详细的错误信息，便于追踪\n        +   log.Printf(\"更新用户信息失败: %v\", err)\n        +   return err\n        + }\n        // 现有代码...\n        ```\n      * **完整性**：提供完整的函数或文件内容，避免使用代码占位符。\n\n#### **第四步：协作规划模式的任务计划**\n\n当进入**协作规划模式**时，我会提供如下格式的任务计划来引导我们的工作。我们共同确认计划后，将逐项执行和更新。\n\n**示例格式：**\n\n```markdown\n### 任务计划：重构用户认证服务\n\n- [ ] **1. 需求与现状分析**\n- [ ] **2. 技术方案设计**\n- [ ] **3. 编码与实现**\n- [ ] **4. 测试与验证**\n- [ ] **5. 交付与总结**\n```\n\n#### **沟通规则**\n\n  * **语言**：默认使用中文与您交流，技术术语保持英文。\n  * **确认机制**：任务完成后，我会通过 `interactive_feedback` 请求您的确认。只有在您确认无误或无新指令时，对话才会结束。",
  "workspace_guidelines": "",
  "feature_detection_flags": {
    "support_tool_use_start": true,
    "support_parallel_tool_use": true
  },
  "tool_definitions": [],
  "nodes": [
    {
      "id": 1,
      "type": 0,
      "text_node": {
        "content": "⚠️ NO TOOLS ALLOWED ⚠️\n\nHere is an instruction that I\'d like to give you, but it needs to be improved. Rewrite and enhance this instruction to make it clearer, more specific, less ambiguous, and correct any mistakes. Do not use any tools: reply immediately with your answer, even if you\'re not sure. Consider the context of our conversation history when enhancing the prompt. If there is code in triple backticks (```) consider whether it is a code sample and should remain unchanged.Reply with the following format:\n\n### BEGIN RESPONSE ###\nHere is an enhanced version of the original instruction that is more specific and clear:\n<augment-enhanced-prompt>enhanced prompt goes here</augment-enhanced-prompt>\n\n### END RESPONSE ###\n\nHere is my original instruction:\n\n当前sidebar的 聊天记录滚动到底部的逻辑 存在一些问题 我现在发送带有参考图的消息的时候 没有滚动到最底部 "
      }
    },
    {
      "id": 2,
      "type": 4,
      "ide_state_node": {
        "workspace_folders": [
          {
            "folder_root": "e:\\ai\\artifex",
            "repository_root": "e:\\ai\\artifex"
          }
        ],
        "workspace_folders_unchanged": false,
        "current_terminal": {
          "terminal_id": 0,
          "current_working_directory": "e:\\ai\\artifex"
        }
      }
    }
  ],
  "mode": "AGENT",
  "agent_memories": "",
  "persona_type": 0,
  "rules": [],
  "silent": true,
  "third_party_override": null,
  "conversation_id": "__NEW_AGENT__"
}' --http1.1